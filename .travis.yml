language: node_js
nvm:
- 10.2.1
env:
- NODE_ENV=testing
global:
- DB_NAME='travis_ci_test'
- DB_PORT=5432
install: npm install
services:
- postgresql
before_script:
- psql -c 'create database travis_ci_test;' -U postgres
- npm run reset
- npm run build
script: npm test
after_success:
- test $TRAVIS_BRANCH = "master" && test $TRAVIS_PULL_REQUEST = "false" && npm run coverage
